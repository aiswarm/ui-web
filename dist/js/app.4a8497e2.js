(function(){"use strict";var e={7799:function(e,t,a){var n=a(4870),l=a(9242),u=a(8275),o=a(6586),r=a(6880),s=a(6289),i=a(958),d=a(5809),c=a(13),m=a(3396);function p(e,t,a,n,l,u){const o=(0,m.up)("Sidebar"),r=(0,m.up)("v-navigation-drawer"),s=(0,m.up)("ChatLog"),i=(0,m.up)("v-row"),d=(0,m.up)("v-col"),c=(0,m.up)("v-container"),p=(0,m.up)("v-main"),f=(0,m.up)("ChatBar"),g=(0,m.up)("v-footer"),v=(0,m.up)("v-app");return(0,m.wg)(),(0,m.j4)(v,null,{default:(0,m.w5)((()=>[(0,m.Wm)(r,{modelValue:e.drawer,"onUpdate:modelValue":t[0]||(t[0]=t=>e.drawer=t),app:""},{default:(0,m.w5)((()=>[(0,m.Wm)(o)])),_:1},8,["modelValue"]),(0,m.Wm)(p,null,{default:(0,m.w5)((()=>[(0,m.Wm)(c,{fluid:"true"},{default:(0,m.w5)((()=>[(0,m.Wm)(i,null,{default:(0,m.w5)((()=>[(0,m.Wm)(d,{cols:"12"},{default:(0,m.w5)((()=>[(0,m.Wm)(i,{height:"100%",justify:"center",align:"center"},{default:(0,m.w5)((()=>[(0,m.Wm)(s)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,m.Wm)(g,{class:"fixed bottom",app:""},{default:(0,m.w5)((()=>[(0,m.Wm)(f)])),_:1})])),_:1})}a(560);var f=a(7139);const g=(0,m._)("h3",null,"Groups",-1),v={key:1},w=(0,m._)("span",{class:"headline"},"Add Group",-1),h=(0,m._)("h3",null,"Agents",-1),_={key:1},b=(0,m._)("span",{class:"headline"},"Add Agent",-1);function k(e,t,a,n,l,u){const o=(0,m.up)("v-badge"),r=(0,m.up)("v-list-item"),s=(0,m.up)("v-btn"),i=(0,m.up)("v-card-title"),d=(0,m.up)("v-text-field"),c=(0,m.up)("v-card-text"),p=(0,m.up)("v-spacer"),k=(0,m.up)("v-card-actions"),y=(0,m.up)("v-card"),W=(0,m.up)("v-dialog"),S=(0,m.up)("v-list"),C=(0,m.up)("v-select");return(0,m.wg)(),(0,m.j4)(y,null,{default:(0,m.w5)((()=>[g,n.groups.length?((0,m.wg)(),(0,m.j4)(S,{key:0},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)(n.groups,(e=>((0,m.wg)(),(0,m.j4)(r,{key:e.name,onClick:t=>n.selectChat(e.name,"group"),class:(0,f.C_)({"selected-chat":e.name===n.targetSelected.name,badge:!0})},{default:(0,m.w5)((()=>[e.count>0?((0,m.wg)(),(0,m.j4)(o,{key:0,content:e.count,floating:"","offset-y":"5","offset-x":"-5",label:"{{group.name}}",color:"#f0f0f0"},{default:(0,m.w5)((()=>[(0,m.Uk)((0,f.zw)(e.name),1)])),_:2},1032,["content"])):((0,m.wg)(),(0,m.iD)("span",v,(0,f.zw)(e.name),1))])),_:2},1032,["onClick","class"])))),128)),(0,m.Wm)(r,null,{default:(0,m.w5)((()=>[(0,m.Wm)(s,{icon:"mdi-plus",onClick:t[0]||(t[0]=e=>n.showAddGroupDialog=!0),density:"compact"}),(0,m.Wm)(W,{modelValue:n.showAddGroupDialog,"onUpdate:modelValue":t[3]||(t[3]=e=>n.showAddGroupDialog=e),"max-width":"290"},{default:(0,m.w5)((()=>[(0,m.Wm)(y,null,{default:(0,m.w5)((()=>[(0,m.Wm)(i,null,{default:(0,m.w5)((()=>[w])),_:1}),(0,m.Wm)(c,null,{default:(0,m.w5)((()=>[(0,m.Wm)(d,{modelValue:n.newGroupName,"onUpdate:modelValue":t[1]||(t[1]=e=>n.newGroupName=e),label:"Group Name",autofocus:"true"},null,8,["modelValue"])])),_:1}),(0,m.Wm)(k,null,{default:(0,m.w5)((()=>[(0,m.Wm)(p),(0,m.Wm)(s,{text:"",onClick:t[2]||(t[2]=e=>n.showAddGroupDialog=!1)},{default:(0,m.w5)((()=>[(0,m.Uk)("Cancel")])),_:1}),(0,m.Wm)(s,{color:"blue darken-1",text:"",onClick:n.addGroup},{default:(0,m.w5)((()=>[(0,m.Uk)("Add")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})):(0,m.kq)("",!0),h,n.agents.length?((0,m.wg)(),(0,m.j4)(S,{key:1},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)(n.agents,(e=>((0,m.wg)(),(0,m.j4)(r,{key:e.name,onClick:t=>n.selectChat(e.name,"agent"),class:(0,f.C_)({"selected-chat":e.name===n.targetSelected.name,badge:!0})},{default:(0,m.w5)((()=>[e.count>0?((0,m.wg)(),(0,m.j4)(o,{key:0,content:e.count,floating:"","offset-y":"5","offset-x":"-5",label:"{{agent.name}}",color:"#f0f0f0"},{default:(0,m.w5)((()=>[(0,m.Uk)((0,f.zw)(e.name),1)])),_:2},1032,["content"])):((0,m.wg)(),(0,m.iD)("span",_,(0,f.zw)(e.name),1))])),_:2},1032,["onClick","class"])))),128)),(0,m.Wm)(r,null,{default:(0,m.w5)((()=>[(0,m.Wm)(s,{icon:"mdi-plus",onClick:t[4]||(t[4]=e=>n.showAddAgentDialog=!0),density:"compact"}),(0,m.Wm)(W,{modelValue:n.showAddAgentDialog,"onUpdate:modelValue":t[8]||(t[8]=e=>n.showAddAgentDialog=e),"max-width":"290"},{default:(0,m.w5)((()=>[(0,m.Wm)(y,null,{default:(0,m.w5)((()=>[(0,m.Wm)(i,null,{default:(0,m.w5)((()=>[b])),_:1}),(0,m.Wm)(c,null,{default:(0,m.w5)((()=>[(0,m.Wm)(d,{modelValue:n.newAgentName,"onUpdate:modelValue":t[5]||(t[5]=e=>n.newAgentName=e),label:"Agent Name",autofocus:"true"},null,8,["modelValue"]),(0,m.Wm)(C,{modelValue:n.selectedDriver,"onUpdate:modelValue":t[6]||(t[6]=e=>n.selectedDriver=e),items:n.drivers,label:"Driver"},null,8,["modelValue","items"])])),_:1}),(0,m.Wm)(k,null,{default:(0,m.w5)((()=>[(0,m.Wm)(p),(0,m.Wm)(s,{text:"",onClick:t[7]||(t[7]=e=>n.showAddAgentDialog=!1)},{default:(0,m.w5)((()=>[(0,m.Uk)("Cancel")])),_:1}),(0,m.Wm)(s,{color:"blue darken-1",text:"",onClick:n.addAgent},{default:(0,m.w5)((()=>[(0,m.Uk)("Add")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})):(0,m.kq)("",!0)])),_:1})}var y=a(7417),W={__name:"SideBar",setup(e,{expose:t}){t();const a=(0,m.f3)("targetSelected"),l={name:"All",type:"group"},u=(0,n.iH)([l]),o=(0,m.f3)("agents"),r=(0,m.f3)("drivers"),s=(0,n.iH)([]);(0,c.aM)(y.Ps`
    query {
      groups {
        name
        members
      }
      agents {
        name
      }
      drivers {
        type
      }
    }
  `).onResult((e=>{e.loading||e.error||(u.value=[l],e.data.groups.forEach((e=>{u.value.push({...e,count:0,lastSeen:0})})),o.value=[],e.data.agents.forEach((e=>{o.value.push({...e,count:0,lastSeen:0})})),r.value=[],e.data.drivers.forEach((e=>{r.value.push(e.type)})),r.value=r.value.sort().filter(((e,t,a)=>0===t||e!==a[t-1])))})),(0,c.mU)(y.Ps`
    subscription {
      groupCreated {
        name
        members
      }
    }
  `).onResult((e=>{if(e.data?.groupCreated){const t=e.data.groupCreated;u.value.find((e=>e.name===t.name))||u.value.push({...t,count:0,lastSeen:0})}})),(0,c.mU)(y.Ps`
    subscription {
      agentCreated {
        name
      }
    }
  `).onResult((e=>{if(e.data?.agentCreated){const t=e.data.agentCreated;o.value.find((e=>e.name===t.name))||o.value.push({...t,count:0,lastSeen:0})}}));const i=(0,m.f3)("messages");(0,m.YP)(i.value,(e=>{e.forEach((e=>{const t=e.target,n=o.value.find((e=>e.name===t))??u.value.find((e=>e.name===t));if(!n)return void console.log(`No agent or group found for target: ${t}`);const l=a.value.name,r=new Date(e.timestamp).getTime();t!==l&&r>n.lastSeen&&n.count++,n.lastSeen=Math.max(r,n.lastSeen)}))}));const d=(e,t)=>{a.value={name:e,type:t},s.value=[e];const n=o.value.find((t=>t.name===e))??u.value.find((t=>t.name===e));n&&(n.count=0)},{mutate:p}=(0,c.Db)(y.Ps`
    mutation CreateGroup($name: String!) {
      createGroup(name: $name)
    }
  `),f=(0,n.iH)(!1),g=(0,n.iH)("");async function v(){""!==g.value.trim()&&(await p({name:g.value}),f.value=!1,g.value="")}const{mutate:w}=(0,c.Db)(y.Ps`
    mutation CreateAgent($name: String!, $driver: String!) {
      createAgent(name: $name, driver: $driver) {
        name
      }
    }
  `),h=(0,n.iH)(!1),_=(0,n.iH)(""),b=(0,n.iH)("");async function k(){""!==_.value.trim()&&b.value&&(await w({name:_.value,driver:b.value}),h.value=!1,_.value="",b.value="")}(0,m.YP)(h,(e=>{e&&1===r.value.length&&(b.value=r.value[0])}));const W={targetSelected:a,defaultGroup:l,groups:u,agents:o,drivers:r,selected:s,messages:i,selectChat:d,addGroupMutation:p,showAddGroupDialog:f,newGroupName:g,addGroup:v,addAgentMutation:w,showAddAgentDialog:h,newAgentName:_,selectedDriver:b,addAgent:k,inject:m.f3,ref:n.iH,watch:m.YP,get useMutation(){return c.Db},get useQuery(){return c.aM},get useSubscription(){return c.mU},get gql(){return y.Ps}};return Object.defineProperty(W,"__isScriptSetup",{enumerable:!1,value:!0}),W}},S=a(89);const C=(0,S.Z)(W,[["render",k]]);var A=C;const D={class:"chat-log"},V={key:0},x={class:"source"},j={class:"content"},M={class:"timestamp"};function U(e,t,a,n,l,u){const o=(0,m.up)("v-toolbar-title"),r=(0,m.up)("v-app-bar");return(0,m.wg)(),(0,m.iD)(m.HY,null,[(0,m.Wm)(r,{app:"",color:"primary",dark:""},{default:(0,m.w5)((()=>[(0,m.Wm)(o,null,{default:(0,m.w5)((()=>[(0,m.Uk)((0,f.zw)(n.targetSelected?.name||"All"),1)])),_:1})])),_:1}),(0,m._)("div",D,[n.localMessages.length?((0,m.wg)(),(0,m.iD)("ul",V,[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)(n.localMessages,((e,t)=>((0,m.wg)(),(0,m.iD)("li",{key:e.id,ref_for:!0,ref:n.setLastMessageRef},[(0,m._)("span",x,(0,f.zw)(e.source)+":",1),(0,m._)("span",j,(0,f.zw)(e.content),1),(0,m._)("span",M,(0,f.zw)(new Date(e.timestamp).toLocaleTimeString()),1)])))),128))])):(0,m.kq)("",!0)])],64)}var H={__name:"ChatLog",setup(e,{expose:t}){t();const a=(0,m.f3)("messages"),l=(0,m.f3)("targetSelected"),u=(0,n.iH)([]),o=(0,n.iH)(null),r=e=>{e&&(o.value=e)};(0,m.m0)((()=>{u.value=a.value.filter((e=>"All"===l.value?.name||e.target===l.value?.name||e.source===l.value?.name)),(0,m.Y3)((()=>{o.value&&o.value.scrollIntoView()}))}));const s={messages:a,targetSelected:l,localMessages:u,lastMessage:o,setLastMessageRef:r,inject:m.f3,nextTick:m.Y3,ref:n.iH,watchEffect:m.m0};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}};const O=(0,S.Z)(H,[["render",U]]);var P=O;function G(e,t,a,n,u,o){const r=(0,m.up)("v-snackbar"),s=(0,m.up)("v-textarea"),i=(0,m.up)("v-col"),d=(0,m.up)("v-icon"),c=(0,m.up)("v-btn"),p=(0,m.up)("v-list-item-title"),f=(0,m.up)("v-switch"),g=(0,m.up)("v-list-item-action"),v=(0,m.up)("v-row"),w=(0,m.up)("v-list-item"),h=(0,m.up)("v-list"),_=(0,m.up)("v-card"),b=(0,m.up)("v-menu");return(0,m.wg)(),(0,m.j4)(v,{"no-gutters":"",align:"end"},{default:(0,m.w5)((()=>[(0,m.Wm)(i,{cols:"11"},{default:(0,m.w5)((()=>[(0,m.Wm)(r,{modelValue:n.snackbar,"onUpdate:modelValue":t[0]||(t[0]=e=>n.snackbar=e),color:"error",timeout:3e3,"close-on-content-click":"",location:"top"},{default:(0,m.w5)((()=>[(0,m.Uk)("Cannot send message to all agents, please select an agent or group")])),_:1},8,["modelValue"]),(0,m.Wm)(s,{id:"messageInput",modelValue:n.messageInput,"onUpdate:modelValue":t[1]||(t[1]=e=>n.messageInput=e),label:"Message","auto-grow":"",rows:1,"max-rows":5,onKeydown:(0,l.D2)(n.handleEnter,["enter"]),disabled:!n.enabled,clearable:""},null,8,["modelValue","onKeydown","disabled"])])),_:1}),(0,m.Wm)(i,{class:"d-flex align-center justify-space-between",cols:"1"},{default:(0,m.w5)((()=>[(0,m.Wm)(c,{class:"btn",icon:"",onClick:e.sendMessage,disabled:!n.enabled},{default:(0,m.w5)((()=>[(0,m.Wm)(d,null,{default:(0,m.w5)((()=>[(0,m.Uk)("mdi-send")])),_:1})])),_:1},8,["onClick","disabled"]),(0,m.Wm)(b,{modelValue:n.menu,"onUpdate:modelValue":t[3]||(t[3]=e=>n.menu=e),"close-on-content-click":!1,"offset-y":""},{activator:(0,m.w5)((({props:e})=>[(0,m.Wm)(c,(0,m.dG)({class:"btn",icon:""},e),{default:(0,m.w5)((()=>[(0,m.Wm)(d,null,{default:(0,m.w5)((()=>[(0,m.Uk)("mdi-dots-vertical")])),_:1})])),_:2},1040)])),default:(0,m.w5)((()=>[(0,m.Wm)(_,{"min-width":"225",height:"65"},{default:(0,m.w5)((()=>[(0,m.Wm)(h,null,{default:(0,m.w5)((()=>[(0,m.Wm)(w,null,{default:(0,m.w5)((()=>[(0,m.Wm)(v,null,{default:(0,m.w5)((()=>[(0,m.Wm)(i,{cols:"9"},{default:(0,m.w5)((()=>[(0,m.Wm)(p,{class:"scrollOnMessageTitle"},{default:(0,m.w5)((()=>[(0,m.Uk)("Scroll on Message")])),_:1})])),_:1}),(0,m.Wm)(i,{cols:"3"},{default:(0,m.w5)((()=>[(0,m.Wm)(g,null,{default:(0,m.w5)((()=>[(0,m.Wm)(f,{modelValue:n.preferences.scrollOnMessage,"onUpdate:modelValue":t[2]||(t[2]=e=>n.preferences.scrollOnMessage=e),density:"compact"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}var $={__name:"ChatBar",setup(e,{expose:t}){t();const a=(0,m.f3)("targetSelected"),l=(0,m.f3)("preferences"),u=(0,n.iH)(""),o=(0,n.iH)(!1),r=(0,n.iH)(!0),s=(0,n.iH)(!1),{mutate:i}=(0,c.Db)(y.Ps`
    mutation SendMessage($message: String!, $target: String!) {
      sendMessage(message: $message, target: $target) {
        id
        content
      }
    }
  `);async function d(e){if(e.preventDefault(),e.altKey||e.metaKey||e.shiftKey)return void(u.value+="\n");const t=a.value.name;if("All"===t)return void(s.value=!0);const n=u.value;n.trim&&""!==n.trim()&&t&&(await i({message:n,target:t}),u.value="")}(0,m.YP)(a.value,(e=>{r.value=!(!e||"All"===e.name)}));const p={targetSelected:a,preferences:l,messageInput:u,menu:o,enabled:r,snackbar:s,sendMessageMutation:i,handleEnter:d,inject:m.f3,ref:n.iH,watch:m.YP,get useMutation(){return c.Db},get gql(){return y.Ps}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}};const E=(0,S.Z)($,[["render",G]]);var Y=E,q={components:{Sidebar:A,ChatLog:P,ChatBar:Y},setup(){const e=(0,n.iH)([]),t=(0,n.iH)([]),a=(0,n.iH)([]),l=(0,n.iH)({type:"group",name:"All"}),{result:u}=(0,c.mU)(y.Ps`
        subscription {
          messageCreated {
            id
            timestamp
            source
            target
            content
            type
          }
        }
      `);(0,m.m0)((()=>{u.value?.messageCreated&&e.value.push(u.value.messageCreated)})),(0,m.JJ)("messages",e),(0,m.JJ)("agents",t),(0,m.JJ)("drivers",a),(0,m.JJ)("targetSelected",l)},data:()=>({drawer:null})};const N=(0,S.Z)(q,[["render",p]]);var z=N,J=a(8957),K=a(8893),T=a(8600);a(8556);const L=new u.u({uri:"http://localhost:4000/graphql"}),R=new d.A({uri:"ws://localhost:4000/graphql",options:{reconnect:!0,connectionCallback:e=>{e&&console.error(`WebSocket connection error: ${e}`)}}}),I=(0,o.V)((({query:e})=>{const t=(0,i.p$)(e);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),R,L),B=new r.f({link:I,cache:new s.h}),Z=(0,n.qj)({scrollOnMessage:!0}),F=(0,l.ri)(z);F.provide(c.Gk,B),F.provide("preferences",Z),F.use((0,J.Rd)({components:K,directives:T})),F.mount("#app")}},t={};function a(n){var l=t[n];if(void 0!==l)return l.exports;var u=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(u.exports,u,u.exports,a),u.loaded=!0,u.exports}a.m=e,function(){var e=[];a.O=function(t,n,l,u){if(!n){var o=1/0;for(d=0;d<e.length;d++){n=e[d][0],l=e[d][1],u=e[d][2];for(var r=!0,s=0;s<n.length;s++)(!1&u||o>=u)&&Object.keys(a.O).every((function(e){return a.O[e](n[s])}))?n.splice(s--,1):(r=!1,u<o&&(o=u));if(r){e.splice(d--,1);var i=l();void 0!==i&&(t=i)}}return t}u=u||0;for(var d=e.length;d>0&&e[d-1][2]>u;d--)e[d]=e[d-1];e[d]=[n,l,u]}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.hmd=function(e){return e=Object.create(e),e.children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e}}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var l,u,o=n[0],r=n[1],s=n[2],i=0;if(o.some((function(t){return 0!==e[t]}))){for(l in r)a.o(r,l)&&(a.m[l]=r[l]);if(s)var d=s(a)}for(t&&t(n);i<o.length;i++)u=o[i],a.o(e,u)&&e[u]&&e[u][0](),e[u]=0;return a.O(d)},n=self["webpackChunk_aiswarm_ui_web"]=self["webpackChunk_aiswarm_ui_web"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(7799)}));n=a.O(n)})();
//# sourceMappingURL=app.4a8497e2.js.map